<?xml version="1.0" standalone="yes"?>
<!DOCTYPE entity [

<!--   <!ENTITY operacionesExternas SYSTEM "file:///operaciones-2.xml"> -->
	
  <!ELEMENT entity        (operacion*)>
  <!ELEMENT operacion     (input* , output* , dataset* , tables*, transformer?, forms)>
  
  <!ELEMENT input		  (campoEntrada*)>	<!--   Es la entrada de la operacion. Lo definido aquí llegará en un mapa a la operacion -->
  <!ELEMENT forms		  (form*)>		  	<!--   Para definir una restriccion y conocer que clients utilizan esta operacion. Es a modo de mantenimiento, por ejemplo: al cambiar una operacion, se debe saber quienes suelen llamar a la operacion para realizar los debidos cambios -->
  <!ELEMENT output		  (campoSalida*)> 	<!--   Define el formato de salida -->
  <!ELEMENT transformer	  EMPTY>			<!--   Define una clase que es la encargada de mostrar los resultados en la salida de la operacion. (Muchas tablas, una sola, en paralelo) -->


  <!ELEMENT campoEntrada  (input*|campoEntrada*)>  
  <!ELEMENT campoSalida   (campoSalida*,output*)>  
  
  <!ELEMENT dataset       (campo*)>
  <!ELEMENT campo         EMPTY>
  <!ELEMENT tables       (tableDef+)>
  <!ELEMENT tableDef     (campoTable*)>
  <!ELEMENT campoTable   EMPTY>
  
  <!ATTLIST transformer clase           CDATA #REQUIRED>
  
  <!ATTLIST form name	CDATA #REQUIRED>
  
  <!ATTLIST input name           	 	CDATA    #IMPLIED><!--   Nombre que se corresponde con la entrada de delphi. Si en delphi mandan el valor Name, acá debe exstir en valor Name para obtener los demas datos -->
  <!ATTLIST input keyName           	CDATA    #IMPLIED><!--   Indica el key del mapa que llega a la operacion. Si el valor es 'leo', se debera recuperar usando la key 'leo' sobre el mapa en la operacion -->
  <!ATTLIST input clase           	 	CDATA    #IMPLIED><!-- 	define la clase del parmetro recibido -->
  <!ATTLIST input fieldID           	CDATA    #IMPLIED><!--   Define que atributo sera utilizado como id de la entida, esto es para recuperarlo de la base, si acá el valor es UN_ID, en delphi deberian mandar el valor UN_ID -->
  <!ATTLIST input nombreEntidad        	CDATA    #IMPLIED>
  
  <!ATTLIST campoEntrada name			CDATA #IMPLIED>
  <!ATTLIST campoEntrada clase			CDATA #IMPLIED>
  <!ATTLIST campoEntrada nombreEntidad	CDATA #IMPLIED>
  <!ATTLIST campoEntrada metodo			CDATA #IMPLIED>
  <!ATTLIST campoEntrada fieldID        CDATA    #IMPLIED><!--   Define que atributo sera utilizado como id de la entida, esto es para recuperarlo de la base, si acá el valor es UN_ID, en delphi deberian mandar el valor UN_ID -->
 
  <!ATTLIST output name					CDATA #REQUIRED> 
  <!ATTLIST output tableName           	CDATA #REQUIRED><!-- va a representar el nombre de la tabla -->

  <!ATTLIST campoSalida tableName		CDATA #IMPLIED> <!-- en caso de ser hijo de otro campoSalida, es una tabla, y este campo tendra el nombre de la tabla -->
  <!ATTLIST campoSalida target			CDATA #IMPLIED> <!-- El nombre del metodo para recuperar los datos -->
  <!ATTLIST campoSalida value			CDATA #IMPLIED> <!-- el valor de la columna que contendra el valor de resltado de target -->

  <!ATTLIST operacion name              ID    #REQUIRED>
  <!ATTLIST operacion clase             CDATA #IMPLIED>
  <!ATTLIST operacion entidad           CDATA #IMPLIED>
  <!ATTLIST operacion XMLWriter         CDATA #IMPLIED>
  <!ATTLIST operacion redirect          CDATA #IMPLIED>
  <!ATTLIST operacion usaJMS            CDATA #IMPLIED>
  
  <!ATTLIST dataset name                CDATA #REQUIRED>
  <!ATTLIST dataset value               CDATA #IMPLIED>
  <!ATTLIST dataset tabla               CDATA #IMPLIED>
  
  <!ATTLIST campo   name                CDATA #REQUIRED>
  <!ATTLIST campo   value               CDATA #IMPLIED>
  
  <!ATTLIST tableDef    name           	CDATA #REQUIRED>

  <!ATTLIST campoTable	name        	CDATA #REQUIRED>
  <!ATTLIST campoTable  orden       	CDATA #IMPLIED>
  <!ATTLIST campoTable  tipo        	CDATA #IMPLIED>
  <!ATTLIST campoTable  longitud    	CDATA #IMPLIED>
  
]>

<entity>

	<!-- TRAER UN CLASIFICADOR Y SUS COMPONENTES -->
	<operacion name="TraerClasificador" clase="com.jkt.varios.operaciones.TraerClasificador">
										
		<output name="clasificador" tableName="mtClasificador">
			<campoSalida value="oid_Clasificador" target="id" />
			<campoSalida value="Codigo" target="codigo" />
			<campoSalida value="Descripcion" target="descripcion" />
			<campoSalida value="oid_Entidad" target="entidad" />  <!-- se supone que es la clase que representa, y no una instancia. -->
			<campoSalida value="Activo" target="isActivo" />	
		</output>
				
		<output name="componentes" tableName="mtComponentesClasificador">		
			<campoSalida value="oid_CompClasif" target="id" />			
			<campoSalida value="codInterno" target="codigoInterno" />			
			<campoSalida value="codInternoPadre" target="codigoInternoPadre" />
			<campoSalida value="Codigo" target="codigo" />
			<campoSalida value="Descripcion" target="descripcion" />
			<campoSalida value="Activo" target="isActivo" />			
		</output>		
		
		<transformer clase="com.jkt.transformers.ParalelResponseListenerTransformer"></transformer>
		
		<forms>
			<form name="FNCla0001"> </form>
		</forms>
		
	</operacion>


	<!-- GUARDAR UN CLASIFICADOR Y SUS COMPONENTES -->
	<operacion name="GuardarClasificador" clase="com.jkt.varios.operaciones.GuardarClasificador">

		<input name="mtClasificador" keyName="objeto" clase="com.jkt.varios.dominio.Clasificador" fieldID="oid_Clasificador">
			<campoEntrada>

				<campoEntrada name="Codigo" clase="String" metodo="setCodigo" />
				<campoEntrada name="Descripcion" clase="String" metodo="setDescripcion" />
				<campoEntrada name="oid_Entidad" clase="String" metodo="setEntidad" />
				<campoEntrada name="Obligatorio" clase="Boolean" metodo="setObligatorio" />
				<campoEntrada name="Activo" clase="Boolean" metodo="setActivo" />

				<campoEntrada name="mtComponentesClasificador" metodo="agregarComponente" clase="com.jkt.varios.dominio.Componente" fieldID="oid_CompClasif">

					<campoEntrada name="codInterno" clase="Integer" metodo="setCodigoInterno" />
					<campoEntrada name="codInternoPadre" clase="Integer" metodo="setCodigoInternoPadre" />

					<campoEntrada name="Codigo" clase="String" metodo="setCodigo" />
					<campoEntrada name="Descripcion" clase="String" metodo="setDescripcion" />
					<campoEntrada name="Activo" clase="Boolean" metodo="setActivo" />
				</campoEntrada>
				
			</campoEntrada>
		</input>
		
		<forms>
			<form name="FNCla0001"></form>
		</forms>
		
	</operacion>




	<!-- TRAER LAS ENTIDADES CLASIFICABLES -->
	<operacion name="TraerEntidadesClasificables" clase="com.jkt.varios.operaciones.TraerEntidadesClasificables">
										
		<output name="entidades" tableName="mtEntidades">		
			<campoSalida value="oid_Entidad" target="codigo" />
			<campoSalida value="Descripcion" target="descripcion" />
		</output>
						
		<transformer clase="com.jkt.transformers.SimpleTransformer"></transformer>
		
		<forms>
			<form name="FNCla0001"> </form>
		</forms>
		
	</operacion>


	<!-- TRAER LOS VALORES DE UN CLASIFICADOR, LOS DATOS DEL CLASIFICADOR Y SUS COMPONENTES (JERARQUIA) -->
	<operacion name="TraerValoresClasificador" clase="com.jkt.varios.operaciones.TraerValoresClasificador">
										
		<output name="clasificador" tableName="mtClasificador">
			<campoSalida value="oid_Clasificador" target="id" />
			<campoSalida value="Codigo" target="codigo" />
			<campoSalida value="Descripcion" target="descripcion" />
		</output>
				
		<output name="componentes" tableName="mtComponentesClasificador">	
			<campoSalida value="oid_CompClasif" target="id" />			
			<campoSalida value="oid_Nivel" target="codigoInterno" />			
			<campoSalida value="oid_NivelPadre" target="codigoInternoPadre" />
			<campoSalida value="Codigo" target="codigo" />
			<campoSalida value="Descripcion" target="descripcion" />
			<campoSalida value="Activo" target="isActivo" />			
		</output>

		<output name="valores" tableName="mtValoresClasificador">					
			<campoSalida value="oid_ValorClasif" target="id" />			
			<campoSalida value="oid_CompClasif" target="componente.id" />			

<!-- 			<campoSalida value="oid_ValorPadre" target="componente.id" />			 -->
<!-- 			<campoSalida value="oid_Valor" target="componente.id" />			 -->
			
			<campoSalida value="codInterno" target="codigoInterno" />			
			<campoSalida value="codInternoPadre" target="codigoInternoPadre" />

			<campoSalida value="Codigo" target="codigo" />
			<campoSalida value="Descripcion" target="descripcion" />
			<campoSalida value="Activo" target="isActivo" />			
		</output>

		<transformer clase="com.jkt.transformers.ParalelResponseListenerTransformer"></transformer>
		
		<forms>
			<form name="FNCla0002"> </form>
		</forms>
		
	</operacion>


	<!-- GUARDAR LOS VALORES DE UN CLASIFICADOR -->
	<operacion name="GuardarValoresClasificador" clase="com.jkt.varios.operaciones.GuardarValoresClasificador">


		<input name="mtClasificador" keyName="clasificador" clase="com.jkt.varios.dominio.Clasificador" fieldID="oid_Clasificador">
			<campoEntrada>

				<campoEntrada name="Codigo" clase="String" metodo="setCodigo" />
				<campoEntrada name="Descripcion" clase="String" metodo="setDescripcion" />
			
			</campoEntrada>
		</input>

		<input name="mtValoresClasificador" keyName="objeto" clase="com.jkt.varios.dominio.ComponenteValor" fieldID='oid_ValorClasif'>
			<campoEntrada>
<!-- 					Campo transiente para recuperar el componente donde se guardan todos los valores -->
					<campoEntrada name="oid_CompClasif" clase="Integer" metodo="setIdComponente" />

<!-- 					Campos transientes para ordenar los nodos -->
					<campoEntrada name="codInterno" clase="Integer" metodo="setCodigoInterno" />
					<campoEntrada name="codInternoPadre" clase="Integer" metodo="setCodigoInternoPadre" />
					
<!-- 					Campos propios del componente valor, persistentes -->
					<campoEntrada name="Codigo" clase="String" metodo="setCodigo" />
					<campoEntrada name="Descripcion" clase="String" metodo="setDescripcion" />
					<campoEntrada name="Activo" clase="Boolean" metodo="setActivo" />
			</campoEntrada>

		</input>
		
		<forms>
			<form name="FNCla0002"></form>
		</forms>
		
	</operacion>
	
	
<!-- 	Traer valores de clasificadores. -->

	<operacion name="TraerValoresDeClasificadores" clase="com.jkt.varios.operaciones.TraerValoresDeClasificadores">
		
		<output name="valores" tableName="mtValores">
			<campoSalida value="oid_Valor" target="id" />
			<campoSalida value="Codigo" target="codigo" /> 
			<campoSalida value="Descripcion" target="descripcion" />
			<campoSalida value="Activo" target="isActivo" />	
		</output>
		
		<transformer clase="com.jkt.transformers.ParalelResponseListenerTransformer"></transformer>

		<forms>
			<form name="---"></form>
		</forms>
		
	</operacion>
	

	<!-- TRAE UN IMPUESTO Y SUS CATEGORIAS DE INSCRIPCION -->
	<operacion name="TraerImpuestos" clase="com.jkt.erp.impuestos.operaciones.TraerImpuestos">
										
		<output name="impuesto" tableName="mtImpuesto">
			<campoSalida value="oid_Impuesto" target="id" />
			<campoSalida value="oid_Comportamiento" target="comportamiento" />
			<campoSalida value="Codigo" target="codigo" /> 
			<campoSalida value="Descripcion" target="descripcion" />
			<campoSalida value="Activo" target="isActivo" />	
		</output>
				
		<output name="categorias" tableName="mtImpuestoCategorias">		
<!-- 			<campoSalida value="oid_ImpCat" target="" />			 -->
			<campoSalida value="oid_Impuesto" target="impuesto.id" />			
			<campoSalida value="oid_Categoria" target="id" />			
			<campoSalida value="Codigo" target="codigo" />
			<campoSalida value="Descripcion" target="descripcion" />
			<campoSalida value="Activa" target="isActivo" />			
		</output>		
		
		<transformer clase="com.jkt.transformers.ParalelResponseListenerTransformer"></transformer>
		
		<forms>
			<form name=""> </form>
		</forms>
		
	</operacion>



	<!-- GUARDAR UN IMPUESTO -->
	<operacion name="GuardarImpuestos" clase="com.jkt.operaciones.GuardarLista">

		<input name="mtImpuesto" keyName="objeto" clase="com.jkt.erp.impuestos.dominio.Impuesto" fieldID='oid_Impuesto'>
			<campoEntrada>

				<campoEntrada name="Codigo" clase="String" metodo="setCodigo" />
				<campoEntrada name="Descripcion" clase="String" metodo="setDescripcion" />
				<campoEntrada name="oid_Comportamiento" clase="String" metodo="setComportamiento" />
				<campoEntrada name="Activo" clase="Boolean" metodo="setActivo" />

				<campoEntrada name="mtImpuestoCategorias" metodo="agregarCategoria" clase="com.jkt.erp.impuestos.dominio.CategoriaImpuesto" fieldID="oid_Categoria">
					<campoEntrada name="Codigo" clase="String" metodo="setCodigo" />
					<campoEntrada name="Descripcion" clase="String" metodo="setDescripcion" />
					<campoEntrada name="Activa" clase="Boolean" metodo="setActivo" />
				</campoEntrada>
				
			</campoEntrada>
		</input>
		
		<forms>
			<form name=""></form>
		</forms>
		
	</operacion>


	<!-- TRAE LOS COMPORTAMIENTOS DEL IMPUESTO -->
	<operacion name="TraerComportamientosImpuesto" clase="com.jkt.erp.impuestos.operaciones.TraerComportamientosImpuesto">
										
		<output name="resultado" tableName="mtComportamientos">		
			<campoSalida value="oid_Comportamiento" target="codigo" />
<!-- 			<campoSalida value="oid_Comportamiento" target="codigo" /> -->
			<campoSalida value="Descripcion" target="descripcion" />
		</output>
						
		<transformer clase="com.jkt.transformers.SimpleTransformer"></transformer>
		
		<forms>
			<form name=""> </form>
		</forms>
		
	</operacion>


	<!-- GUARDAR Idioma  -->
	<operacion name="GuardarIdioma" clase="com.jkt.operaciones.GuardarLista">
		<input name="mtInput" keyName="objeto" clase="com.jkt.varios.dominio.Idioma" fieldID='oid'>
			<campoEntrada>			
				<campoEntrada name="Codigo" clase="String" metodo="setCodigo" />
				<campoEntrada name="descr"  clase="String" metodo="setDescripcion" />
				<campoEntrada name="Activo" clase="Boolean" metodo="setActivo" />
			</campoEntrada>			
		</input>		

		<forms>
			<form name=""> </form>
		</forms>
		
	</operacion>


	<!-- RECUPERAR  Idioma -->
	<operacion name="TraerIdioma" clase="com.jkt.operaciones.TraerEntidades" entidad="com.jkt.varios.dominio.Idioma">
		<output name="resultado" tableName="mtInput">
			<campoSalida value="oid" target="id" />
			<campoSalida value="Codigo"    target="codigo" />
			<campoSalida value="descr"     target="descripcion" />
			<campoSalida value="Activo"    target="isActivo" />
		</output>		
			
		<transformer clase="com.jkt.transformers.SimpleTransformer"></transformer>
		
		<forms>
			<form name=""></form>
		</forms>		
	</operacion>
	

	<!-- GUARDAR Pais  -->
	<operacion name="GuardarPais" clase="com.jkt.operaciones.GuardarLista">
		<input name="mtInput" keyName="objeto" clase="com.jkt.varios.dominio.Pais" fieldID='oid'>
			<campoEntrada>			
				<campoEntrada name="Codigo" clase="String" metodo="setCodigo" />
				<campoEntrada name="descr"  clase="String" metodo="setDescripcion" />
				<campoEntrada name="Activo" clase="Boolean" metodo="setActivo" />
			</campoEntrada>			
		</input>		

		<forms>
			<form name=""> </form>
		</forms>
		
	</operacion>


	<!-- RECUPERAR  Pais -->
	<operacion name="TraerPais" clase="com.jkt.operaciones.TraerEntidades" entidad="com.jkt.varios.dominio.Pais">
		<output name="resultado" tableName="mtInput">
			<campoSalida value="oid" target="id" />
			<campoSalida value="Codigo"    target="codigo" />
			<campoSalida value="descr"     target="descripcion" />
			<campoSalida value="Activo"    target="isActivo" />
		</output>		
			
		<transformer clase="com.jkt.transformers.SimpleTransformer"></transformer>
		
		<forms>
			<form name=""></form>
		</forms>		
	</operacion>
	


	<!-- GUARDAR Provincia  -->
	<operacion name="GuardarProvincia" clase="com.jkt.operaciones.GuardarLista">
		<input name="mtInput" keyName="objeto" clase="com.jkt.varios.dominio.Provincia" fieldID='oid_prov'>
			<campoEntrada>			
				<campoEntrada name="Codigo" clase="String" metodo="setCodigo" />
				<campoEntrada name="descr"  clase="String" metodo="setDescripcion" />
				<campoEntrada name="Activo" clase="Boolean" metodo="setActivo" />
				<campoEntrada name="oid_pais" clase="com.jkt.varios.dominio.Pais" metodo="setPais" />
			</campoEntrada>			
		</input>		

		<forms>
			<form name=""> </form>
		</forms>
		
	</operacion>


	<!-- RECUPERAR  Provincia -->
	<operacion name="TraerProvincia" clase="com.jkt.operaciones.TraerEntidades" entidad="com.jkt.varios.dominio.Provincia">
		<output name="resultado" tableName="mtInput">
			<campoSalida value="oid_prov" target="id" />
			<campoSalida value="Codigo"    target="codigo" />
			<campoSalida value="descr"     target="descripcion" />
			<campoSalida value="Activo"    target="isActivo" />
			<campoSalida value="oid_pais"    target="pais.id" />
			<campoSalida value="cod_pais"    target="pais.codigo" />
			<campoSalida value="des_pais"    target="pais.descripcion" />
		</output>		
			
		<transformer clase="com.jkt.transformers.SimpleTransformer"></transformer>
		
		<forms>
			<form name=""></form>
		</forms>		
	</operacion>
	
	
	
	<!-- GUARDAR Unidad de medida  -->
	<operacion name="GuardarUnidadMedida" clase="com.jkt.operaciones.GuardarLista">
		<input name="mtInput" keyName="objeto" clase="com.jkt.varios.dominio.UnidadMedida" fieldID='oid'>
			<campoEntrada>
				<campoEntrada name="Codigo" clase="String" metodo="setCodigo" />
				<campoEntrada name="descr"  clase="String" metodo="setDescripcion" />
				<campoEntrada name="Activo" clase="Boolean" metodo="setActivo" />
			</campoEntrada>
		</input>		

		<forms>
			<form name=""> </form>
		</forms>
		
	</operacion>

	<!-- RECUPERAR  Unidad de medida -->
	<operacion name="TraerUnidadMedida" clase="com.jkt.operaciones.TraerEntidades" entidad="com.jkt.varios.dominio.UnidadMedida">
		<output name="resultado" tableName="mtInput">
			<campoSalida value="oid" target="id" />
			<campoSalida value="Codigo"    target="codigo" />
			<campoSalida value="descr"     target="descripcion" />
			<campoSalida value="Activo"    target="isActivo" />
		</output>		
			
		<transformer clase="com.jkt.transformers.SimpleTransformer"></transformer>
		
		<forms>
			<form name=""></form>
		</forms>		
	</operacion>

</entity>
