<?xml version="1.0" standalone="yes"?>
<!DOCTYPE entity [

  <!ELEMENT entity        (operacion*)>
  <!ELEMENT operacion     (input* , output* , listas? , dataset* , tables*, transformer?, forms)>
<!--   <!ELEMENT operacion     (input* , output* , dataset* , tables*, transformer?, forms)> -->
  
  <!ELEMENT input		  (campoEntrada*)>	<!--   Es la entrada de la operacion. Lo definido aquí llegará en un mapa a la operacion -->
  <!ELEMENT forms		  (form*)>		  	<!--   Para definir una restriccion y conocer que clients utilizan esta operacion. Es a modo de mantenimiento, por ejemplo: al cambiar una operacion, se debe saber quienes suelen llamar a la operacion para realizar los debidos cambios -->
  <!ELEMENT output		  (campoSalida*)> 	<!--   Define el formato de salida -->
  <!ELEMENT transformer	  EMPTY>			<!--   Define una clase que es la encargada de mostrar los resultados en la salida de la operacion. (Muchas tablas, una sola, en paralelo) -->
  
  <!ELEMENT listas		  (lista*)>			<!--   Son las listas para mostrar en la salida-->

  <!ELEMENT lista  (lista*)>  
  <!ATTLIST lista nombreWriter		CDATA    #REQUIRED>
  <!ATTLIST lista nombreLista       CDATA    #REQUIRED>


  <!ELEMENT campoEntrada  (input*|campoEntrada*)>  
  <!ELEMENT campoSalida   (campoSalida*,output*)>  
  
  <!ELEMENT dataset       (campo*)>
  <!ELEMENT campo         EMPTY>
  <!ELEMENT tables       (tableDef+)>
  <!ELEMENT tableDef     (campoTable*)>
  <!ELEMENT campoTable   EMPTY>
  
  <!ATTLIST transformer clase           CDATA #REQUIRED>
  
  <!ATTLIST form name	CDATA #REQUIRED>
  
  <!ATTLIST input name           	 	CDATA    #IMPLIED><!--   Nombre que se corresponde con la entrada de delphi. Si en delphi mandan el valor Name, acá debe exstir en valor Name para obtener los demas datos -->
  <!ATTLIST input keyName           	CDATA    #IMPLIED><!--   Indica el key del mapa que llega a la operacion. Si el valor es 'leo', se debera recuperar usando la key 'leo' sobre el mapa en la operacion -->
  <!ATTLIST input clase           	 	CDATA    #IMPLIED><!-- 	define la clase del parmetro recibido -->
  <!ATTLIST input fieldID           	CDATA    #IMPLIED><!--   Define que atributo sera utilizado como id de la entida, esto es para recuperarlo de la base, si acá el valor es UN_ID, en delphi deberian mandar el valor UN_ID -->
  <!ATTLIST input nombreEntidad        	CDATA    #IMPLIED>
  
  <!ATTLIST campoEntrada name			CDATA #IMPLIED>
  <!ATTLIST campoEntrada clase			CDATA #IMPLIED>
  <!ATTLIST campoEntrada nombreEntidad	CDATA #IMPLIED>
  <!ATTLIST campoEntrada metodo			CDATA #IMPLIED>
  <!ATTLIST campoEntrada fieldID        CDATA #IMPLIED><!--   Define que atributo sera utilizado como id de la entida, esto es para recuperarlo de la base, si acá el valor es UN_ID, en delphi deberian mandar el valor UN_ID -->
 
  <!ATTLIST output name					CDATA #REQUIRED> 
  <!ATTLIST output tableName           	CDATA #REQUIRED><!-- va a representar el nombre de la tabla -->

  <!ATTLIST campoSalida tableName		CDATA #IMPLIED> <!-- en caso de ser hijo de otro campoSalida, es una tabla, y este campo tendra el nombre de la tabla -->
  <!ATTLIST campoSalida target			CDATA #IMPLIED> <!-- El nombre del metodo para recuperar los datos -->
  <!ATTLIST campoSalida value			CDATA #IMPLIED> <!-- el valor de la columna que contendra el valor de resltado de target -->

  <!ATTLIST operacion name              ID    #REQUIRED>
  <!ATTLIST operacion clase             CDATA #IMPLIED>
  <!ATTLIST operacion entidad           CDATA #IMPLIED>
  <!ATTLIST operacion XMLWriter         CDATA #IMPLIED>
  <!ATTLIST operacion redirect          CDATA #IMPLIED>
  <!ATTLIST operacion usaJMS            CDATA #IMPLIED>
  
  <!ATTLIST dataset name                CDATA #REQUIRED>
  <!ATTLIST dataset value               CDATA #IMPLIED>
  <!ATTLIST dataset tabla               CDATA #IMPLIED>
  
  <!ATTLIST campo   name                CDATA #REQUIRED>
  <!ATTLIST campo   value               CDATA #IMPLIED>
  
  <!ATTLIST tableDef    name           	CDATA #REQUIRED>

  <!ATTLIST campoTable	name        	CDATA #REQUIRED>
  <!ATTLIST campoTable  orden       	CDATA #IMPLIED>
  <!ATTLIST campoTable  tipo        	CDATA #IMPLIED>
  <!ATTLIST campoTable  longitud    	CDATA #IMPLIED>
  
]>

<entity>

<!-- 	ESTAS SON OPERACIONES DE PRUEBA PARA VERIFICAR EL COMPORTAMIENTO DE LA NUEVA OPERACION TRAERENTIDADESCONRELACIONES Y A MODO DE EJEMPLO PARA LOS DESARROLLADORES. -->
<!-- 	ESTAS SON OPERACIONES DE PRUEBA PARA VERIFICAR EL COMPORTAMIENTO DE LA NUEVA OPERACION TRAERENTIDADESCONRELACIONES Y A MODO DE EJEMPLO PARA LOS DESARROLLADORES. -->
<!-- 	ESTAS SON OPERACIONES DE PRUEBA PARA VERIFICAR EL COMPORTAMIENTO DE LA NUEVA OPERACION TRAERENTIDADESCONRELACIONES Y A MODO DE EJEMPLO PARA LOS DESARROLLADORES. -->
<!-- 	ESTAS SON OPERACIONES DE PRUEBA PARA VERIFICAR EL COMPORTAMIENTO DE LA NUEVA OPERACION TRAERENTIDADESCONRELACIONES Y A MODO DE EJEMPLO PARA LOS DESARROLLADORES. -->
<!-- 	ESTAS SON OPERACIONES DE PRUEBA PARA VERIFICAR EL COMPORTAMIENTO DE LA NUEVA OPERACION TRAERENTIDADESCONRELACIONES Y A MODO DE EJEMPLO PARA LOS DESARROLLADORES. -->

	<operacion name="TrearClientesSucursalesDomicilios" clase="com.jkt.operaciones.TraerEntidadesConRelaciones" entidad="com.jkt.erp.varios.Cliente" >

		<output name="entidad" tableName="mtCliente">
			<campoSalida value="oid_cliente" target="id" />
		</output>
		
		<output name="mtSucursales" tableName="mtSucursales">
			<campoSalida value="oid_sucursal" target="id" />
			<campoSalida value="oid_cliente" target="cliente.id" />
		</output>		
		
		<output name="mtDomiciliosEntrega" tableName="mtDomEntrega">
			<campoSalida value="oid_sucursal" 	target="clienteSucursal.id" />
			<campoSalida value="oid_domicilio_entrega" 	target="id" />
			<campoSalida value="oid_direccion" 	target="direccion.id" />
		</output>		
			
		<listas>
			<lista nombreLista="listaSucursales" nombreWriter="mtSucursales">
				<lista nombreLista="domiciliosDeEntrega" nombreWriter="mtDomiciliosEntrega" />
			</lista>
		</listas>
			
		<transformer clase="com.jkt.transformers.ParalelResponseListenerTransformer" />
		
		<forms>
			<form name="TEmpresa" />
		</forms>
		
	</operacion>
	
	<operacion name="TraerProductoYDetalles" clase="com.jkt.operaciones.TraerEntidadesConRelaciones" entidad="com.jkt.erp.articulos.TipoProducto" >

		<output name="entidad" tableName="mtTipoProducto">
			<campoSalida value="oid_TipoProducto" 	target="id" />
		</output>
		
		<output name="mtDetalles" tableName="mtDetallesTipoProducto">
			<campoSalida value="oid_detalle" 	target="id" />
			<campoSalida value="oid_tipo_producto" 		target="tipoProducto.id" />
			<campoSalida value="oid_caracteristica_id" 		target="caracteristica.id" />
			<campoSalida value="oid_caracteristica_tipo_dato" 		target="caracteristica.tipoDato" />
		</output>		
			
		<listas>
			<lista nombreLista="caracteristicas" nombreWriter="mtDetalles" />
		</listas>
			
		<transformer clase="com.jkt.transformers.ParalelResponseListenerTransformer" />
		
		<forms>
			<form name="TEmpresa"></form>
		</forms>
		
	</operacion>



<!-- OPERACIONES A NIVEL ZERO. CONFIGURACION, PARAMETRIZACION, ETC. -->
<!-- OPERACIONES A NIVEL ZERO. CONFIGURACION, PARAMETRIZACION, ETC. -->

	<!-- RECUPERAR  Configuracion -->
	<operacion name="TraerConfiguracion" clase="com.jkt.operaciones.TraerEntidades" entidad="com.jkt.dominio.Configuracion">
		<output name="resultado" tableName="mtInput">
			<campoSalida value="oid_configuracion" target="id" />
			<campoSalida value="Nombre" target="nombre" />
			
			<campoSalida value="ValorCadena" target="valorCadena" />
			<campoSalida value="ValorEntero" target="valorEntero" />
			<campoSalida value="ValorDoble" target="valorDoble" />
			<campoSalida value="ValorFecha" target="valorFecha" />
			<campoSalida value="ValorBoolean" target="isValorBooleano" />
			
			<campoSalida value="Activo" target="isActivo" />
		</output>
			
		<transformer clase="com.jkt.transformers.SimpleTransformer" />
		
		<forms>
			<form name="---" />
		</forms>
	</operacion>
	
	<!-- GUARDAR Todas las configuraciones -->
	<operacion name="GuardarConfiguracion" clase="com.jkt.operaciones.GuardarLista">
		<input name="mtInput" keyName="objeto" clase="com.jkt.dominio.Configuracion" fieldID='oid_configuracion'>
			<campoEntrada>			
				<campoEntrada name="Nombre"  clase="String" metodo="setNombre" />
				
				<campoEntrada name="ValorCadena" clase="String" metodo="setValorCadena" />
				<campoEntrada name="ValorEntero" clase="Integer" metodo="setValorEntero" />
				<campoEntrada name="ValorDoble" clase="Double" metodo="setValorDoble" />
				<campoEntrada name="ValorFecha" clase="Date" metodo="setValorFecha" />
				<campoEntrada name="ValorBoolean" clase="Boolean" metodo="setValorBooleano" />
				
				<campoEntrada name="Activo" clase="Boolean" metodo="setActivo" />
			</campoEntrada>			
		</input>

		<forms>
			<form name="---" />
		</forms>
		
	</operacion>
	
	<!-- RECUPERAR  Configuracion -->
	<operacion name="TraerParametro" clase="com.jkt.operaciones.TraerParametro" >
		<output name="configuracion" tableName="mtParametrosForm">
			<campoSalida value="oid_param" target="id" />
			<campoSalida value="codigo" target="nombre" />
			
			<campoSalida value="valor_cadena" target="valorCadena" />
			<campoSalida value="valor_entero" target="valorNumero" />
			<campoSalida value="valor_fecha" target="valorFecha" />
			<campoSalida value="valor_float" target="valorDoble" />
			<campoSalida value="valor_boolean" target="isValorBooleano" />

		</output>
			
		<transformer clase="com.jkt.transformers.SimpleTransformer" />
		
		<forms>
			<form name="FNVen0001" />
		</forms>

	</operacion>


</entity>
